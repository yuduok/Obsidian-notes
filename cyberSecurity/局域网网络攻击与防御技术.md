### 内网安全管理

**网络监控**：针对局域网内的计算机进行监视和控制

**网络监控方式**：软硬结合

**网络监控软件运行原理**：

1. 监听模式：
  - 被动接收和分析网络流量
  - 抓取总线MAC层数据帧，不直接干预或修改网络数据包
  - 通常使用镜像端口
2. 网关模式：
  - 主动拦截和转发网络流量
  - 作为网络流量的中间节点，可以实时检查、过滤和分析数据包
  - 部署在路由器或交换机这些网络的关键位置
---
### 网络攻击的定义和分类

**目的**：破坏信息的五个性质——见[[网络安全概论]]

#### 网络攻击的分类

1. 被动攻击类型:攻击者只是观察和分析网络中传输的数据，而不干扰信息流
  - 嗅探信息
  - 非法访问
  - 数据流分析

2. 主动攻击类型：攻击者对某个连接中通过的数据进行各种处理
  - 篡改信息：截获Bos发出的消息篡改后再转发给Alice
  - 欺骗攻击：伪装成Bob，欺骗Alice
  - 拒绝服务攻击：阻塞、破坏服务器，使之无法响应客户请求
  - 重放攻击：窃听并记录消息，伪装成Bob再重发给Alice

欺骗攻击 compare to 重放攻击
![[Pasted image 20241221202301.png]]

---

#### 窃听攻击的原理

不影响信息的正常传输，对网络和主机透明（参考集线器）

#### 交换MAC溢出攻击

原理：黑客终端通过**耗尽**交换机转发表的存储空间，使得交换机无法根据收到的MAC帧在转发表中添加新的转发项，导致交换机以**广播**方式完成正常MAC帧的传输

**防御**：限制每个端口允许接收的源MAC地址不同的MAC帧数量

---
### 截获攻击

原理：改变信息的传输路径，A->B 变为 **A->hacker->B**

#### MAC地址欺骗

防御：
- 把端口和MAC地址绑定
- 划分VLAN防御MAC地址欺骗攻击（与正常终端连接的交换机端口划分为一个vlan，不同vlan之间相互隔离）

#### DHCP欺骗攻击

原理：因为终端会选择**最先**对其请求进行响应的DHCP服务器为其提供网络信息，伪造的DHCP服务器会将黑客终端的IP地址作为默认网关

防御：管理员确认允许接收DHCP响应消息的交换机端口，交换机丢弃所有从其他端口接收到的DHCP响应消息

#### ARP（地址解析协议）欺骗攻击

ARP：网络设备通过ARP请求和应答获取目标设备的MAC地址

原理：攻击者通过伪造的ARP消息消息，使网络中的其他设备将攻击者的MAC地址与目标IP关联起来

防御：交换机建立正确的MAC地址与IP地址之间的绑定关系，丢弃所有错误的MAC地址与IP地址之间的绑定

#### 生成树欺骗攻击

生成树协议：通过阻塞端口将一个原本存在环路的的以太网拓扑结构转换成树形拓扑结构

原理：黑客终端配置为最高优先级的交换机从而成为根交换机，终端之间的数据传输会经过黑客终端

防御：不该接收并处理桥协议数据单元BPDU的交换机端口接收并处理了BPDU，则不允许其参与网络生成树的建立过程

#### 路由项欺骗攻击

攻击者发送伪造的路由更新信息使路由器信任这些虚假信息，网络流量被错误地重定向

防御：路由器接收到路由信息后，首先需要**鉴别**路由信息的发送端，并对路由信息进行**完整性检测**，确定路由信息是由经过**认证**的相邻路由器发送，且路由信息传输过程中**没被篡改**，才处理该路由信息，并更新路由表

---

### 欺骗攻击

定义：用错误的信息误导网络数据传输过程和用户资源访问过程的攻击行为

#### 源IP地址欺骗攻击

定义：某个终端发送IP分组时，不以该终端真实的IP地址作为源IP地址，而是用**其他终端的IP**，或者**伪造**一个本不存在的IP地址作为IP分组的源IP

防御：网络接收到某个IP分组时，首先**判别**该IP分组的源IP地址是否与发送该IP分组的终端IP地址一致，不一致则终止转发

防御：**主机具有防御**入侵能力；交换机**防止伪造**DHCP服务器接入，只允许经过**认证的DHCP服务器**接入以太网；终端**鉴别web服务器**，证实后才可访问
#### 钓鱼网站

实施原理：

终端入侵
  - hosts文件劫持：将终端的hosts文件添加域名xxx与IP地址xxx的绑定项
  - 假域名服务器：将终端中配置的本地域名服务器改为假的域名服务器，在假的域名服务器中配置域名xxx与IP地址xxx的绑定项

非终端入侵
  - 参考DHCP欺骗攻击[[#DHCP欺骗攻击]]

---

### 嗅探攻击

- 破坏信息的保密性
- 嗅探攻击是实现数据流分析攻击的前提
- 实施重放攻击

#### 防御

- 对于集线器实现的，防止黑客终端接入
- 对于交换机实现的，防止接入交换机和防止MAC表溢出
- 无线通信过程无法避免嗅探攻击，需要对信息**加密**

---

### 拒绝服务攻击

用某种方式耗尽**网络设备、链路或服务器资源**，使其无法正常提供服务

#### SYN泛洪攻击

针对**服务器**的Dos攻击，通过大量未完成的TCP连接，快速耗尽web服务器会话表资源

防御：使网络具有阻止**伪造源IP地址**的ip分组继续传输

#### Smurf攻击

针对**网络带宽**的Dos攻击

ICMP协议：Internet Control Message Protocol互联网控制消息协议，主要用于发送错误消息和操作消息

- ping过程：直接ping攻击目标
- ping间接攻击：黑客终端通过普通终端ping攻击目标，使得黑客终端对攻击目标是**透明**的，导致**很难直接追踪**到黑客终端
- ping放大攻击：黑客终端**广播**发送请求，让大量普通终端ping攻击目标
- Smurf攻击：利用ICMP协议和IP广播地址的特性（定向广播地址），通过放大效应来耗尽服目标系统的网络带宽

防御：网络阻止**伪造源IP地址**的IP分组继续传输；路由器阻止以**直接广播地址**为目的IP地址的IP分组继续转发；主机系统**拒绝响应**ICMP ECHO请求报文

#### 拒绝服务攻击

针对**处理器、网络带宽**的DoS攻击

- 直接DDoS攻击：黑客控制大量肉鸡对攻击目标发送报文
- 间接DDoS攻击：黑客控制大量肉鸡对大量正常主机系统发送报文，让正常主机系统对攻击目标发送反射报文

防御：**减少肉鸡**；主机系统**拒绝响应**ICMP ECHO请求报文；使网络具有统计目的I**P地址相同**的ICMP ECHO响应报文，或ICMP差错报告报文数量的能力，如果网络中单位时间内经过的目的IP地址相同，或**ICMP差错报告报文**的数量超过设定阈值，网络能够**丢弃**部分ICMP ECHO响应报文或ICMP差错报告报文

---

### 非法接入和登陆

非法接入：非授权**终端**与无线局域网中的AP（access point接入点）建立关联

非法登陆：非授权**用户**远程登录网络设备和服务器，对网络设备和服务器进行配置和管理
#### 非法接入无线局域网

获得SSID：黑客终端通过**侦听**信帧标或**探测**响应帧获得AP的SSID

由于共享密钥鉴别机制中，鉴别响应和鉴别请求是明文发送的且使用一次性密钥，黑客终端可以通过运算欺骗AP接入无线局域网

防御：AP不用通过**一次性密钥**K异或随机数P生成的密文Y来证明授权终端拥有共享密钥GK

#### 非法登陆

方法：
1. 明文传输直接截获
2. 暴力破解
3. 社会工程学推测

防御：加密传输；口令具备一定长度，同时包含数字、大写字母等

