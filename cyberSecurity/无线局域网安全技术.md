### 基础无线局域网络结构

WLAN：指一个无线站点（如接入点AP，Access Point）充当中心站，所有无线节点对网络的访问均由其控制的网络。

接入点为通信的中心，为无线节点提供连接，是**非对等**的；为了与接入点关联，必须将无线节点的服务集标识符（**SSID**）配置成接入点的SSID。

### 有线等效保密协议WEP

WEP（wired equivalent privacy）
- 802.11b中定义的最基本安全加密
- 采用RC4
- 目标：
  - 访问控制：**防止没有WEP密钥的非法用户访问**
  - 保护隐私：通过**加密保护数据传输**

WEP支持64、128bit加密
- 64位有时称40位加密
- 128位有时称104位加密
  
#### WEP鉴别机制

1. WEP鉴别机制类型

开放系统认证：
- 不进行实质性身份验证
- 任何设备都可以尝试连接

共享密钥认证：
- 需要预共享密钥
- 更复杂的认证过程
- 提供基本的接入控制

2. **开放系统认证流程**

```plaintext
客户端                   接入点
1. 认证请求 --------->
2. <--------- 认证响应
3. 关联请求 --------->
4. <--------- 关联响应
```

特点：
- 不验证客户端身份
- 仅检查是否允许接入
- 安全性极低

3. **共享密钥认证流程**

```plaintext
客户端                   接入点
1. 认证请求 --------->
2. <--------- 明文挑战
3. 使用WEP密钥加密挑战 --------->
4. 验证加密结果 <---------
5. 关联请求 --------->
6. <--------- 关联响应
```

认证步骤：
- 接入点发送明文挑战
- 客户端使用共享密钥加密挑战
- 接入点验证加密结果

4. 认证机制安全缺陷

- 静态密钥管理缺陷：所有终端共享相同密钥
- 共享密钥认证机制的安全缺陷：攻击者可以获取到当前使用的一次性K（challenge和IV明文传输）
- 一次性密钥字典（IV24位，会被穷举）
- 完整性检测缺陷（CRC算法的缺陷）

5. 新的安全技术

- IEEE 802.11i
  1. 基于用户配置密钥，且采用动态配置机制，一次性密钥数量达2^48
  2. 具有完整性检测机制
  3. 具有鉴别身份机制
- WPA（WI-FI联盟，WEP到IEEE 802.11i的过渡方案）
- WAPI（我国提出的无线网鉴别和保密基础结构）

6. 现有的无线局域网安全协议

- WPA（WI-FI Protected Access）
- PSK（Pre-shared Key）

### 802.11i加密机制

主要采用的加密机制有
 - TKIP（Temporary Key Integrity Protocol）临时密钥完整性协议
 - CCMP（CTR with CBC-MAC Protocol）计数器模式密码块链消息认证码
#### TKIP-兼容WEP

设计背景：
- 为解决WEP的安全缺陷
- 作为WPA过渡阶段的临时解决方案
- 兼容早期802.11硬件

主要特点：
- 动态密钥管理
- 改进的密钥混合机制
- 序列号防重放攻击
- RC4加密算法的改进版

TKIP工作原理：
```plaintext
密钥混合过程：
1. 基础密钥
2. MAC地址
3. 序列号
↓
生成每包唯一密钥
```

安全增强机制：
- 每个数据包使用不同密钥
- 48位序列号（防重放）
- 消息完整性检查（MIC）

#### CCMP 

设计背景：
- WPA2的标准加密机制
- 基于AES算法
- 提供更强的安全性

主要特点：
- 对称加密
- 硬件级加密支持
- 强消息完整性保护

CCMP加密流程：
```plaintext
输入：
- 明文数据
- 加密密钥
- 随机数/计数器

处理：
1. 数据分块
2. AES加密
3. 生成消息完整性码

输出：
- 加密数据
- 完整性校验码
```

3. TKIP  CCMP 详细对比

| 特性   | TKIP    | CCMP     |
| ---- | ------- | -------- |
| 加密算法 | RC4（改进） | AES      |
| 密钥长度 | 临时/动态   | 固定（128位） |
| 安全性  | 中等      | 高        |
| 性能   | 较低      | 较高       |
| 适用阶段 | WPA过渡   | WPA2标准   |

### 802.11i到鉴别机制 802.1x

801.11i的安全性基于以下特点：
- 基于用户身份认证
- 和AP建立安全关联，并在建立安全关联时分配临时密钥TK
- 802.1x完成双向的、基于用户的身份认证

#### 802.1X 认证框架

基本组件：
- 客户端（请求者）
- 认证服务器（通常是 RADIUS）
- 接入点（认证器）

认证流程：
```plaintext
客户端        接入点        认证服务器
   |             |               |
1. 连接请求 ---->|               |
   |             |               |
2. <---- EAP请求 |               |
   |             |               |
3. EAP响应 ----->|               |
   |             |--- EAP转发 -->|
   |             |               |
4. <-- 认证结果 --|               |
   |             |               |
5. 生成会话密钥 <-----------------
```

#### EAP 认证方法

常见 EAP 类型：
- PEAP（受保护的 EAP）
- EAP-TLS（传输层安全）
- EAP-TTLS（隧道传输层安全）
- EAP-SIM（SIM 卡认证）

### WPA

#### WPA compare to WEP

| WEP缺陷         | WPA/TKIP改进                    |
| ------------- | ----------------------------- |
| IV长度24位，太短    | IV长度增加到48位                    |
| ICV漏洞         | CRC校验被Michael算法取代，计算颗粒度达64bit |
| 静态密钥，不更新      | 由主密钥动态派生临时密钥，每个客户端不同          |
| 无有效防护机制，无重放保护 | 使用TKIP算法将IV作为帧计数器以提供重放保护      |

#### WPA2

WPA = IEEE 802.11i draft 3 = IEEE 802.1X/EAP + WEP(选择性项目)/TKIP

WPA2 = IEEE 802.11i = IEEE 802.1X/EAP + WEP(选择性项目)/TKIP/CCMP

**WPA2个人模式**

- 使用预共享密码
- 基于口令的密钥导出
- 不需要额外的认证服务器


**WPA2已经成为无线网络的标准安全协议**

#### WPA3

核心技术包括
- SEA协议（Simultaneous Authentication of Equals）同步认证交换
  1. 替代了WPA2的PSK
  2. 基于Dragonfly密钥交换，抵抗离线字典攻击
- 加密的开放网络：引入加密机制，防止传统开放网络中用户数据被窃听
- 前向保密性：即使攻击者未来获取到**某一时刻**的加密密钥，仍无法解密之前的通信数据

### 各协议比较

![[Pasted image 20241223213658.png]]