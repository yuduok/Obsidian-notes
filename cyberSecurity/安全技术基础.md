## 密码学算法

### 古典密码学算法

- 凯撒密码（选定一个位移数即密钥进行加密）
- Vigenere密码（使用字母表中的移位规则进行加密）
- Hill密码（运用基本矩阵论原理进行加密）
![[Pasted image 20241222221358.png]]
- 置换密码（保持明文的所有字符不变，只是利用置换打乱了明文的位置和次序）

**Kerckhoff‘s原则**：所有加密解密算法都是公开的，保密的只是密钥

### 现代密码算法

#### 对称密码

- **序列密码算法（流密码）**
  
  RC4:
  1. 用key生成S盒
  2. 利用S盒生成密钥流

- **分组加密算法（Block Cipher）**
  
  DES：
	  初始置换IP
	  逆初始置换IP^-1
	  16轮迭代的乘积变换
	  16个子密钥产生器

  SM4：
	  分组长度和密钥长度均为128比特，加密算法与密钥扩展都采用32轮非线形迭代结构

  SM1，SM7
  
  DES compare to SM4
![[Pasted image 20241222223148.png]]
#### 非对称密码

- 基于因子分解（大素数分解）难题：
  
  RSA：
	1. 密钥生成
	- 选择两个大质数p和q
	- 计算n = p * q
	- 计算φ(n) = (p-1) * (q-1)
	- 选择与φ(n)互质的整数e
	- 计算e的模反元素d
	
	2. 加密过程
	- 公式：C = M^e mod n
	- M为明文，C为密文
	- 使用公钥(n, e)加密
	
	3. 解密过程
	- 公式：M = C^d mod n
	- 使用私钥(n, d)解密

  SM2，SM9
  
- 基于离散对数难题：
  
  ECC：
	1. 数学基础
	- 基于椭圆曲线方程：y² = x³ + ax + b
	- 定义在有限域上的点集
	- 点之间存在特定的加法和乘法运算
	
	2. 密钥生成
	- 选择椭圆曲线参数
	- 选择基点G
	- 私钥k：随机选择的大整数
	- 公钥P：P = k * G
	
	3. 加密流程（ECDH密钥交换）
	- 发送方Alice：
	  1) 选择私钥dA
	  2) 计算公钥PA = dA * G
	- 接收方Bob：
	  1) 选择私钥dB
	  2) 计算公钥PB = dB * G
	- 共享密钥：
	  1) Alice计算：dA * PB
	  2) Bob计算：dB * PA
	  3) 两者计算结果相同

#### 消息摘要算法

MD5（数据填充为512bit的整数倍），SHA1，SHA256，SM3（杂凑值长度为256bit）

#### 密钥交换算法

Diffle Hellman：
	1. 基本原理
	- 允许两方在不安全的通道上协商共享密钥
	- 基于离散对数问题
	- 不需要事先共享秘密信息
	
	2. 数学模型
	- 选择大素数p
	- 选择生成元g（原根）
	- 满足：1 < g < p
	
	3. 密钥交换流程
	Alice操作：
	- 选择私密随机数a
	- 计算公开值A = g^a mod p
	
	Bob操作：
	- 选择私密随机数b
	- 计算公开值B = g^b mod p
	
	4. 共享密钥生成
	- Alice计算：K = B^a mod p
	- Bob计算：K = A^b mod p
	- 最终K值完全相同

## 认证技术

### 消息完整性检测流程

![[Pasted image 20241222231137.png]]

但攻击者可以讲消息替换为自己的消息，那么由函数计算出的数字指纹也会被判定为有效

解决方案：
1. 阻止嗅探
2. 阻止攻击者穷举出函数f
3. **防止消息伪造**

#### 来源验证

![[Pasted image 20241222231606.png]]

消息认证 = 完整性 + 来源真实性
消息认证吗： MAC（Message Authentication Code）= Ck（M）

优化：使用HMAC（hash值相等则说明传输信息未被篡改）

隐患：能保证通信双方数据不被第三方攻击，但因为MAC基于双方共享的对称密钥，任何一方都可以伪造合法的MAC，所以**不能保证双方自身的相互欺骗**，可以引入非对称加密技术实现防抵赖

#### 消息认证防抵赖

1. 基本原理

- 使用非对称加密技术
- 私钥签名，公钥验证
- 确保消息来源和完整性

2. 签名流程

- 发送方：
1. 对消息计算哈希值
2. 使用私钥加密哈希值
3. 生成数字签名

- 接收方：
1. 使用发送方公钥解密签名
2. 验证哈希值是否一致
   
加密/签名结合应用方案既提供**保密性**，又提供**数字签名**

如果公钥基础设施**PKI**（Public Key Infrastructure）不安全，则可能导致伪造公钥的情况